<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Controle - Camaquã</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <h1>Sistema de Controle</h1>
        <nav class="nav">
            <a id="nav-abastecimento" class="active">Abastecimento</a>
            <a id="nav-veiculos">Veículos</a>
            <a id="nav-historico">Histórico</a>
        </nav>
        <div class="user-info">
            <span>zezoblaskowskitavares@gmail.com</span>
            <button class="btn btn-sm btn-danger">Sair</button>
        </div>
    </header>

    <section id="section-abastecimento" class="section active">
        <div class="container">
            <main class="main-content">
                <div class="card">
                    <h2>1. Carregar Saldo na Máquina (Entrada)</h2>
                    <form id="form-entrada">
                        <div class="form-row">
                            <div class="form-group" style="flex:1;">
                                <label for="veiculo-select">Máquina</label>
                                <select id="veiculo-select" required></select>
                            </div>
                            <div class="form-group" style="flex:1;">
                                <label for="litros-adicionar">Litros a Adicionar</label>
                                <input type="number" id="litros-adicionar" step="0.01" required>
                            </div>
                        </div>
                        <button type="submit" class="btn">Adicionar Saldo</button>
                    </form>
                </div>
                <div class="card">
                    <h2>2. Registrar Abastecimento no Campo (Saída)</h2>
                    <form id="form-saida">
                        <div class="form-row">
                            <div class="form-group" style="flex: 2;">
                                <label>Leitura do Hidrômetro da Bomba</label>
                                <div class="form-row" style="margin-bottom: 0; display:flex; gap: 1.5rem;">
                                    <input type="number" id="leitura-inicial" placeholder="Leitura Inicial" step="0.01" required>
                                    <input type="number" id="leitura-final" placeholder="Leitura Final" step="0.01" required>
                                </div>
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label>Total Abastecido</label>
                                <div class="total-display"><span id="total-abastecido">0 L</span></div>
                            </div>
                        </div>
                        <div class="form-row" style="display:flex; gap: 1.5rem;">
                            <div class="form-group" style="flex:1;"><label for="horimetro">Horímetro / Odômetro</label><input type="text" id="horimetro"></div>
                            <div class="form-group" style="flex:1;"><label for="operador">Operador</label><input type="text" id="operador"></div>
                        </div>
                        <div class="form-group"><label for="observacao">Observação</label><textarea id="observacao"></textarea></div>
                        <button type="submit" id="btn-registrar-saida" class="btn" disabled>Registrar Abastecimento</button>
                    </form>
                </div>
                <div class="card">
                    <h2>Histórico de Operações Recentes</h2>
                    <div id="historico-container"></div>
                </div>
            </main>
            <aside class="sidebar">
                <div class="card" id="info-maquina">
                    <h2>Informações da Máquina</h2>
                    <p>Selecione uma máquina para iniciar a operação.</p>
                </div>
            </aside>
        </div>
    </section>

    <section id="section-veiculos" class="section">
        <div class="container" style="display:block;">
            <div class="card">
                <div style="display:flex; justify-content: space-between; align-items: center;">
                    <h2>Gerenciamento da Frota</h2>
                    <button id="btn-novo-veiculo" class="btn btn-sm">Adicionar Novo Veículo</button>
                </div>
                <table class="table">
                    <thead><tr><th>Nome</th><th>Tipo</th><th>Ações</th></tr></thead>
                    <tbody id="lista-veiculos"></tbody>
                </table>
            </div>
        </div>
    </section>

    <section id="section-historico" class="section">
        <div class="container" style="display:block;">
            <div class="card">
                <h2>Histórico Detalhado de Operações</h2>
                <div class="filtros-container">
                    <div class="form-group"><label for="filtro-veiculo">Filtrar por Veículo</label><select id="filtro-veiculo"></select></div>
                    <div class="form-group"><label for="filtro-data-inicio">Data de Início</label><input type="date" id="filtro-data-inicio"></div>
                    <div class="form-group"><label for="filtro-data-fim">Data de Fim</label><input type="date" id="filtro-data-fim"></div>
                    <button id="btn-buscar-historico" class="btn btn-sm">Buscar</button>
                </div>
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr><th>Data</th><th>Veículo</th><th>Operação</th><th>Litros</th><th>Operador</th><th>Horímetro/Odômetro</th></tr>
                        </thead>
                        <tbody id="historico-detalhado-body"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <div id="veiculo-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2 id="modal-title">Adicionar Veículo</h2>
            <form id="veiculo-form">
                <input type="hidden" id="veiculo-id">
                <div class="form-group"><label for="veiculo-nome">Nome</label><input type="text" id="veiculo-nome" required></div>
                <div class="form-group"><label for="veiculo-tipo">Tipo</label><input type="text" id="veiculo-tipo"></div>
                <button type="submit" class="btn">Salvar</button>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="script.js"></script>
</body>
</html>